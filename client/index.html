<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
body { font-family:sans-serif; text-align:center; }
.grid { display:grid; grid-template-columns:repeat(6,1fr); gap:6px; }
.card {
  aspect-ratio:1; background:#333; color:#fff;
  display:flex; align-items:center; justify-content:center;
  border-radius:10px; font-size:24px;
  transition:transform .3s;
}
.card.flipped { background:#fff; color:#000; transform:rotateY(180deg); }
.card.removed { visibility:hidden; }
.firework { font-size:32px; animation:pop 1s infinite; }
@keyframes pop { 50%{transform:scale(1.3)} }
</style>
</head>
<body>

<h3 id="turn"></h3>
<div class="grid" id="grid"></div>
<div id="result"></div>

<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
const socket = io("http://localhost:3000");
const grid = document.getElementById("grid");

socket.emit("createRoom", {
  roomName: "í…ŒìŠ¤íŠ¸ë°©",
  nickname: "kim",
  maxPlayers: 5
});

socket.on("gameStarted", room => {
  grid.innerHTML = "";
  room.deck.forEach(card => {
    const el = document.createElement("div");
    el.className = "card";
    el.textContent = "â“";
    el.onclick = () => socket.emit("flipCard", {
      roomId: room.roomId,
      cardId: card.id
    });
    el.id = card.id;
    grid.appendChild(el);
  });
});

socket.on("cardFlipped", card => {
  const el = document.getElementById(card.id);
  el.classList.add("flipped");
  el.textContent = card.pairId;
});

socket.on("pairMatched", ({ cards }) => {
  cards.forEach(id =>
    document.getElementById(id).classList.add("removed")
  );
});

socket.on("pairMismatched", cards => {
  cards.forEach(id => {
    const el = document.getElementById(id);
    el.classList.remove("flipped");
    el.textContent = "â“";
  });
});

socket.on("gameEnded", ranking => {
  document.getElementById("result").innerHTML =
    ranking.map((p,i)=>`${i+1}ìœ„ ${p.nickname} (${p.score})`).join("<br>");

  if (ranking[0].nickname === "kim") {
    document.getElementById("result").innerHTML +=
      "<div class='firework'>ðŸŽ‰ 1ìœ„ ì¶•í•˜! ðŸŽ‰</div>";
  }
});
</script>
</body>
</html>
